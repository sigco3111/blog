---
layout: default
custom_css: categories
---

<div class="category-page">
    <header class="category-header">
        <h1>{{ page.category | default: "알 수 없는 카테고리" }}</h1>
        <p class="category-description">
            {% if page.paginator %}
                {% assign post_count = page.paginator.total_posts %}
                총 {{ post_count }}개의 포스트
                {% if page.paginator.total_pages > 1 %}
                    ({{ page.paginator.page }}/{{ page.paginator.total_pages }} 페이지)
                {% endif %}
            {% else %}
                {% assign category_posts = site.categories[page.category] %}
                {% if page.category == "미분류" %}
                    {% assign category_posts = site.posts | where: "categories", empty %}
                {% elsif page.category == nil or page.category == "" %}
                    {% assign category_posts = site.posts | limit: 0 %}
                {% endif %}
                {% assign post_count = category_posts.size | default: 0 %}
                총 {{ post_count }}개의 포스트
            {% endif %}
        </p>
    </header>

    <div class="posts-list">
        {% comment %} 페이징된 포스트 또는 전체 카테고리 포스트 사용 {% endcomment %}
        {% if page.paginator %}
            {% assign category_posts = page.paginator.posts %}
            {% assign total_posts = page.paginator.total_posts %}
        {% else %}
            {% comment %} 카테고리 포스트 할당 및 오류 처리 {% endcomment %}
            {% if page.category == "미분류" %}
                {% assign category_posts = site.posts | where: "categories", empty %}
            {% elsif page.category == nil or page.category == "" %}
                {% assign category_posts = site.posts | limit: 0 %}
            {% else %}
                {% assign category_posts = site.categories[page.category] %}
                {% unless category_posts %}
                    {% assign category_posts = site.posts | limit: 0 %}
                {% endunless %}
            {% endif %}
            {% assign total_posts = category_posts.size %}
        {% endif %}

        {% comment %} 포스트 목록 표시 또는 빈 상태 처리 {% endcomment %}
        {% if category_posts.size > 0 %}
            {% assign sorted_posts = category_posts | sort: 'date' | reverse %}
            {% for post in sorted_posts %}
                <article class="post-item">
                    <div class="post-meta">
                        <time datetime="{{ post.date | date_to_xmlschema }}">
                            {{ post.date | date: "%Y년 %m월 %d일" }}
                        </time>
                    </div>

                    <h2 class="post-title">
                        <a href="{{ post.url | relative_url }}">{{ post.title | escape | default: "제목 없음" }}</a>
                    </h2>

                    <div class="post-excerpt">
                        {% if post.excerpt and post.excerpt != "" %}
                            {{ post.excerpt | strip_html | truncatewords: 30 }}
                        {% elsif post.content and post.content != "" %}
                            {{ post.content | strip_html | truncatewords: 30 }}
                        {% else %}
                            <em>내용 미리보기가 없습니다.</em>
                        {% endif %}
                    </div>

                    <div class="post-categories">
                        {% if post.categories.size > 0 %}
                            {% for category in post.categories %}
                                <span class="category-tag">{{ category }}</span>
                            {% endfor %}
                        {% else %}
                            <span class="category-tag">미분류</span>
                        {% endif %}
                    </div>
                </article>
            {% endfor %}

            {% comment %} 카테고리 페이징 추가 {% endcomment %}
            {% if page.paginator %}
                {% include pagination.html paginator=page.paginator %}
            {% endif %}
        {% else %}
            {% comment %} 빈 상태 메시지 - 카테고리 유형에 따라 다른 메시지 표시 {% endcomment %}
            <div class="empty-state">
                {% if page.category == "미분류" %}
                    <p>미분류 포스트가 없습니다.</p>
                    <p class="empty-state-subtitle">모든 포스트가 적절한 카테고리로 분류되어 있습니다.</p>
                {% elsif page.category == nil or page.category == "" %}
                    <p>잘못된 카테고리입니다.</p>
                    <p class="empty-state-subtitle">요청하신 카테고리를 찾을 수 없습니다.</p>
                {% else %}
                    <p>{{ page.category }} 카테고리에는 아직 포스트가 없습니다.</p>
                    <p class="empty-state-subtitle">첫 번째 포스트를 작성해보세요!</p>
                {% endif %}
                <div class="empty-state-actions">
                    <a href="{{ '/' | relative_url }}" class="back-link">홈으로 돌아가기</a>
                    <a href="{{ '/categories/' | relative_url }}" class="back-link secondary">모든 카테고리 보기</a>
                </div>
            </div>
        {% endif %}
    </div>

    <div class="category-navigation">
        <a href="{{ '/categories/' | relative_url }}" class="back-to-categories">모든 카테고리 보기</a>
    </div>
</div>