<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Settings Test - Jekyll Admin</title>
    <link rel="stylesheet" href="assets/css/admin.css">
    <style>
        body {
            padding: 2rem;
            background-color: #f8f9fa;
        }
        .test-container {
            max-width: 1200px;
            margin: 0 auto;
        }
        .test-header {
            background: white;
            padding: 2rem;
            border-radius: 8px;
            margin-bottom: 2rem;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .test-section {
            background: white;
            padding: 2rem;
            border-radius: 8px;
            margin-bottom: 2rem;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
    </style>
</head>
<body>
    <div class="test-container">
        <div class="test-header">
            <h1>Settings Configuration Test</h1>
            <p>Jekyll Admin ì‚¬ì´íŠ¸ ì„¤ì • ê´€ë¦¬ ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸</p>
            <button id="load-settings-btn" class="btn btn-primary">ì„¤ì • ë¡œë“œ í…ŒìŠ¤íŠ¸</button>
            <button id="validate-test-btn" class="btn btn-outline">ìœ íš¨ì„± ê²€ì‚¬ í…ŒìŠ¤íŠ¸</button>
        </div>

        <div class="test-section">
            <h2>ConfigManager í…ŒìŠ¤íŠ¸</h2>
            <div id="config-test-results">
                <p>í…ŒìŠ¤íŠ¸ ê²°ê³¼ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤...</p>
            </div>
        </div>

        <div class="test-section">
            <h2>ì„¤ì • í¼ í…ŒìŠ¤íŠ¸</h2>
            <div id="settings-form-container">
                <!-- Settings form will be rendered here -->
            </div>
        </div>
    </div>

    <script type="module">
        import { ConfigManager } from './assets/js/modules/config-manager.js';

        class SettingsTest {
            constructor() {
                this.configManager = new ConfigManager();
                this.init();
            }

            async init() {
                console.log('Settings test initialized');
                
                // Setup event listeners
                document.getElementById('load-settings-btn').addEventListener('click', () => {
                    this.testConfigLoad();
                });
                
                document.getElementById('validate-test-btn').addEventListener('click', () => {
                    this.testValidation();
                });

                // Run initial tests
                await this.runInitialTests();
            }

            async runInitialTests() {
                const resultsDiv = document.getElementById('config-test-results');
                
                try {
                    // Test ConfigManager instantiation
                    resultsDiv.innerHTML += '<p>âœ… ConfigManager ì¸ìŠ¤í„´ìŠ¤ ìƒì„± ì„±ê³µ</p>';
                    
                    // Test default config
                    const defaultConfig = this.configManager.getConfig();
                    resultsDiv.innerHTML += `<p>âœ… ê¸°ë³¸ ì„¤ì • ë¡œë“œ: ${Object.keys(defaultConfig).length}ê°œ í•„ë“œ</p>`;
                    
                    // Test validation
                    const validation = this.configManager.validateConfig(defaultConfig);
                    resultsDiv.innerHTML += `<p>âœ… ìœ íš¨ì„± ê²€ì‚¬: ${validation.isValid ? 'í†µê³¼' : 'ì‹¤íŒ¨'}</p>`;
                    
                } catch (error) {
                    resultsDiv.innerHTML += `<p>âŒ í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨: ${error.message}</p>`;
                }
            }

            async testConfigLoad() {
                const resultsDiv = document.getElementById('config-test-results');
                
                try {
                    resultsDiv.innerHTML += '<p>ğŸ”„ ì„¤ì • ë¡œë“œ í…ŒìŠ¤íŠ¸ ì¤‘...</p>';
                    
                    const config = await this.configManager.loadConfig();
                    resultsDiv.innerHTML += `<p>âœ… ì„¤ì • ë¡œë“œ ì„±ê³µ: ${JSON.stringify(config, null, 2)}</p>`;
                    
                } catch (error) {
                    resultsDiv.innerHTML += `<p>âŒ ì„¤ì • ë¡œë“œ ì‹¤íŒ¨: ${error.message}</p>`;
                }
            }

            testValidation() {
                const resultsDiv = document.getElementById('config-test-results');
                
                // Test various validation scenarios
                const testCases = [
                    {
                        name: 'ìœ íš¨í•œ ì„¤ì •',
                        config: {
                            title: 'Test Blog',
                            email: 'test@example.com',
                            description: 'A test blog',
                            url: 'https://test.github.io',
                            baseurl: '/blog'
                        }
                    },
                    {
                        name: 'ì˜ëª»ëœ ì´ë©”ì¼',
                        config: {
                            title: 'Test Blog',
                            email: 'invalid-email',
                            description: 'A test blog'
                        }
                    },
                    {
                        name: 'ì˜ëª»ëœ URL',
                        config: {
                            title: 'Test Blog',
                            email: 'test@example.com',
                            description: 'A test blog',
                            url: 'not-a-url'
                        }
                    },
                    {
                        name: 'í•„ìˆ˜ í•„ë“œ ëˆ„ë½',
                        config: {
                            url: 'https://test.github.io'
                        }
                    }
                ];

                resultsDiv.innerHTML += '<h3>ìœ íš¨ì„± ê²€ì‚¬ í…ŒìŠ¤íŠ¸ ê²°ê³¼:</h3>';
                
                testCases.forEach(testCase => {
                    const validation = this.configManager.validateConfig(testCase.config);
                    const status = validation.isValid ? 'âœ…' : 'âŒ';
                    
                    resultsDiv.innerHTML += `
                        <div style="margin: 1rem 0; padding: 1rem; border: 1px solid #ddd; border-radius: 4px;">
                            <h4>${status} ${testCase.name}</h4>
                            <p>ìœ íš¨ì„±: ${validation.isValid ? 'í†µê³¼' : 'ì‹¤íŒ¨'}</p>
                            ${validation.errors.length > 0 ? `<p>ì˜¤ë¥˜: ${validation.errors.join(', ')}</p>` : ''}
                            ${validation.warnings && validation.warnings.length > 0 ? `<p>ê²½ê³ : ${validation.warnings.join(', ')}</p>` : ''}
                        </div>
                    `;
                });
            }
        }

        // Initialize test when DOM is loaded
        document.addEventListener('DOMContentLoaded', () => {
            new SettingsTest();
        });
    </script>
</body>
</html>