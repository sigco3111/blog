{% comment %}
페이징 컴포넌트
사용법: {% include pagination.html paginator=paginator %}
{% endcomment %}

{% if include.paginator.total_pages > 1 %}
<div class="pagination-container">
  <nav class="pagination-nav" role="navigation" aria-label="페이지 네비게이션">
    <ul class="pagination">
      {% comment %} 이전 페이지 버튼 {% endcomment %}
      {% if include.paginator.previous_page %}
        <li class="prev">
          <a href="{{ include.paginator.previous_page_path | relative_url }}" 
             rel="prev" 
             aria-label="이전 페이지">
            이전
          </a>
        </li>
      {% else %}
        <li class="prev disabled">
          <span aria-label="이전 페이지 없음">이전</span>
        </li>
      {% endif %}

      {% comment %} 페이지 번호들 {% endcomment %}
      {% assign start_page = 1 %}
      {% assign end_page = include.paginator.total_pages %}
      
      {% comment %} 페이지가 많을 때 범위 제한 {% endcomment %}
      {% if include.paginator.total_pages > 7 %}
        {% assign current = include.paginator.page %}
        {% if current <= 4 %}
          {% assign start_page = 1 %}
          {% assign end_page = 5 %}
        {% elsif current >= include.paginator.total_pages | minus: 3 %}
          {% assign start_page = include.paginator.total_pages | minus: 4 %}
          {% assign end_page = include.paginator.total_pages %}
        {% else %}
          {% assign start_page = current | minus: 2 %}
          {% assign end_page = current | plus: 2 %}
        {% endif %}
      {% endif %}

      {% comment %} 첫 페이지와 생략 표시 {% endcomment %}
      {% if start_page > 1 %}
        <li>
          {% if include.paginator.category %}
            <a href="{{ '/category/' | append: include.paginator.category | append: '/' | relative_url }}" 
               aria-label="1페이지로 이동">1</a>
          {% else %}
            <a href="{{ '/' | relative_url }}" 
               aria-label="1페이지로 이동">1</a>
          {% endif %}
        </li>
        {% if start_page > 2 %}
          <li class="gap">
            <span aria-hidden="true">…</span>
          </li>
        {% endif %}
      {% endif %}

      {% comment %} 페이지 번호 범위 {% endcomment %}
      {% for page_num in (start_page..end_page) %}
        {% if page_num == include.paginator.page %}
          <li>
            <span class="current" aria-current="page" aria-label="현재 페이지, {{ page_num }}페이지">
              {{ page_num }}
            </span>
          </li>
        {% else %}
          <li>
            {% if page_num == 1 %}
              {% if include.paginator.category %}
                {% comment %} 카테고리 페이징의 첫 페이지 {% endcomment %}
                <a href="{{ '/category/' | append: include.paginator.category | append: '/' | relative_url }}" 
                   aria-label="{{ page_num }}페이지로 이동">{{ page_num }}</a>
              {% else %}
                {% comment %} 홈페이지 페이징의 첫 페이지 {% endcomment %}
                <a href="{{ '/' | relative_url }}" aria-label="{{ page_num }}페이지로 이동">{{ page_num }}</a>
              {% endif %}
            {% else %}
              {% if include.paginator.category %}
                {% comment %} 카테고리 페이징 {% endcomment %}
                <a href="{{ '/category/' | append: include.paginator.category | append: '/page' | append: page_num | append: '/' | relative_url }}" 
                   aria-label="{{ page_num }}페이지로 이동">{{ page_num }}</a>
              {% else %}
                {% comment %} 홈페이지 페이징 {% endcomment %}
                <a href="{{ site.paginate_path | replace: ':num', page_num | relative_url }}" 
                   aria-label="{{ page_num }}페이지로 이동">{{ page_num }}</a>
              {% endif %}
            {% endif %}
          </li>
        {% endif %}
      {% endfor %}

      {% comment %} 마지막 페이지와 생략 표시 {% endcomment %}
      {% if end_page < include.paginator.total_pages %}
        {% if end_page < include.paginator.total_pages | minus: 1 %}
          <li class="gap">
            <span aria-hidden="true">…</span>
          </li>
        {% endif %}
        <li>
          {% if include.paginator.category %}
            <a href="{{ '/category/' | append: include.paginator.category | append: '/page' | append: include.paginator.total_pages | append: '/' | relative_url }}" 
               aria-label="마지막 페이지, {{ include.paginator.total_pages }}페이지로 이동">
              {{ include.paginator.total_pages }}
            </a>
          {% else %}
            <a href="{{ site.paginate_path | replace: ':num', include.paginator.total_pages | relative_url }}" 
               aria-label="마지막 페이지, {{ include.paginator.total_pages }}페이지로 이동">
              {{ include.paginator.total_pages }}
            </a>
          {% endif %}
        </li>
      {% endif %}

      {% comment %} 다음 페이지 버튼 {% endcomment %}
      {% if include.paginator.next_page %}
        <li class="next">
          <a href="{{ include.paginator.next_page_path | relative_url }}" 
             rel="next" 
             aria-label="다음 페이지">
            다음
          </a>
        </li>
      {% else %}
        <li class="next disabled">
          <span aria-label="다음 페이지 없음">다음</span>
        </li>
      {% endif %}
    </ul>
  </nav>

  {% comment %} 페이징 정보 {% endcomment %}
  <div class="pagination-info" role="status" aria-live="polite">
    <strong>{{ include.paginator.page }}</strong> / {{ include.paginator.total_pages }} 페이지
    (총 <strong>{{ include.paginator.total_posts }}</strong>개 포스트)
  </div>
</div>
{% endif %}